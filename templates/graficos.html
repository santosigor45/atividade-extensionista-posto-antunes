{% extends 'base.html' %}

{% block title %}
    Gr√°ficos
{% endblock %}

{% block content %}
    {% include 'flash.html' %}
    <div class="container" style="width: 100%; max-width: 10000px;">
        <div class="div-menu">
            <p class="texts">Ajuste os filtros abaixo para exibir o gr√°fico</p>

            <!-- Controles de per√≠odo -->
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px;">Per√≠odo</label>
                <button id="prevMonth">&lt;</button>
                <span id="monthLabel"></span>
                <button id="nextMonth">&gt;</button>
                <button id="customBtn">Outro</button>

                <div id="customInputs" style="display: none; margin-bottom: 15px; margin-top: 5px;">
                    <input type="date" id="startDate">
                    <input type="date" id="endDate">
                </div>
            </div>

            <div style="display: flex; margin-bottom: 15px;">
                <!-- Select de combust√≠vel -->
                <div style="width: 50%; text-align: right; padding-right: 15px;">
                    <label style="display: block; margin-bottom: 5px;">Combust√≠vel</label>
                    <select id="combSelect">
                        <option value="">Todos</option>
                        <option value="DIESEL S-10" selected>Diesel-S10</option>
                        <option value="GASOLINA">Gasolina</option>
                    </select>
                </div>

                <!-- Select de tipo de gr√°fico-->
                <div>
                    <label style="display: block; margin-bottom: 5px;">Tipo de gr√°fico</label>
                    <select id="metricSelect" style="margin-left: 8px;">
                        <option value="efficiency">Km por Litro</option>
                        <option value="volume">Volume (L)</option>
                    </select>
                </div>
            </div>


            <!-- Select de cidade -->
            <div style="margin-bottom: 30px;">
                <label style="display: block; margin-bottom: 5px;">Cidade</label>
                <select id="citySelect">
                    <option value="">Todas</option>
                    <option value="CIDADE 1">Cidade 1</option>
                    <option value="CIDADE 2" selected>Cidade 2</option>
                    <option value="CIDADE 3">Cidade 3</option>
                    <option value="CIDADE 4">Cidade 4</option>
                </select>
            </div>
        </div>

        <!-- Bot√£o de imprimir -->
        <div style="text-align: center; margin: 16px 0;">
            <button id="printBtn" class="btn btn-outline-primary" style="width: 20%;">Imprimir Gr√°fico</button>
        </div>

        <!-- Canvas do gr√°fico -->
        <div id="chartContainer">
            <div>
                <canvas id="abastecimentosChart" style="height: 700px; padding: 0 15px 0 15px;"></canvas>
            </div>
            <div id="chartSummary" style="text-align:center; margin-top: 60px; font-size:20px;"></div>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.3.1/dist/chartjs-plugin-annotation.min.js"></script>
    <script src="{{ url_for('static', filename='js/chart/graficos.js') }}"></script>
    <script>
        // libera os gr√°ficos apenas para dispositivos com tela maior que 990px
        (function(){
            if (!window.matchMedia('(min-width: 990px)').matches) {
                document.querySelector('.container').innerHTML = `
                    <div class="div-menu">
                        <h1 style="text-align: center;">üîí Acesso restrito</h1>
                        <p class="texts">
                            A se√ß√£o de gr√°ficos s√≥ est√° dispon√≠vel para tablets e computadores.
                        </p>
                        <h1 style="text-align: center;">üñ•Ô∏è</h1>
                    </div>
                `;
            }
        })();
    </script>
{% endblock %}
